<div id="chart-container" style="position: relative;">
    <div class="loading" v-if="isLoading">åŠ è½½ä¸­...</div>

    <div class="drawing-toolbar">
        <button :class="{ active: currentTool === 'cursor' }" @click="setTool('cursor')" title="å…‰æ ‡">ğŸ‘†</button>
        <button :class="{ active: currentTool === 'line' }" @click="setTool('line')" title="ç›´çº¿">â•±</button>
        <button :class="{ active: currentTool === 'ray' }" @click="setTool('ray')" title="å°„çº¿">âš</button>
        <button :class="{ active: currentTool === 'horizontal' }" @click="setTool('horizontal')" title="æ¨ªçº¿">â”€</button>
        <button :class="{ active: currentTool === 'fib' }" @click="setTool('fib')" title="æ–æ³¢é‚£å¥‘å›è°ƒ">â‰¡</button>
        <button :class="{ active: currentTool === 'parallel' }" @click="setTool('parallel')" title="ç­‰è·é€šé“">âˆ¥</button>
        <button @click="clearDrawings" title="æ¸…é™¤æ‰€æœ‰">ğŸ—‘ï¸</button>
    </div>
    <canvas id="drawing-canvas" ref="drawingCanvas" style="position: absolute; top: 0; left: 0; z-index: 5; pointer-events: none;"></canvas>
    
        <div class="chart-error" v-if="chartError.show">
        <div class="error-content">
            <div class="error-icon">âš ï¸</div>
            <div class="error-title">å›¾è¡¨åŠ è½½å¤±è´¥</div>
            <div class="error-desc">[[ chartError.message ]]</div>
            <div class="error-detail" v-if="chartError.detail">[[ chartError.detail ]]</div>
            <button class="retry-btn" @click="retryLoad">é‡è¯•</button>
        </div>
    </div>

    <div ref="chartRef" style="width: 100%; height: 100%;"></div>

    <div class="candle-tooltip" id="candle-tooltip" style="display: none;">
        <div class="tooltip-time" id="tooltip-time"></div>
        <div class="tooltip-row" id="row-open">
            <span class="tooltip-label">å¼€ç›˜</span>
            <span class="tooltip-value" id="tooltip-open">--</span>
        </div>
        <div class="tooltip-row" id="row-high">
            <span class="tooltip-label">æœ€é«˜</span>
            <span class="tooltip-value" id="tooltip-high">--</span>
        </div>
        <div class="tooltip-row" id="row-low">
            <span class="tooltip-label">æœ€ä½</span>
            <span class="tooltip-value" id="tooltip-low">--</span>
        </div>
        <div class="tooltip-row">
            <span class="tooltip-label">æ”¶ç›˜</span>
            <span class="tooltip-value" id="tooltip-close">--</span>
        </div>
        <div class="tooltip-row">
            <span class="tooltip-label">æ¶¨è·Œ</span>
            <span class="tooltip-value" id="tooltip-change">--</span>
        </div>
        <div class="tooltip-row">
            <span class="tooltip-label">æˆäº¤é‡</span>
            <span class="tooltip-value" id="tooltip-volume">--</span>
        </div>
    </div>
    <div id="no-data-overlay" style="position: absolute; left: 0; top: 0; bottom: 28px; width: 0; background: rgba(255, 255, 255, 0.08); border-right: 1px solid rgba(255, 255, 255, 0.2); display: none; pointer-events: none; z-index: 5; align-items: center; justify-content: center; color: rgba(255, 255, 255, 0.5); font-size: 13px; overflow: hidden; white-space: nowrap; backdrop-filter: blur(1px);">æ— æ•°æ®</div>
</div>